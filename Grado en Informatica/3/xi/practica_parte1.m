##duda -> amplitud me da mas de 0.5 no me tiene sentido la del ejemplo ##sin ruido##x=4 cosenos ##plots del principio estan para 3, no 4##cmd+r -> comentar##cmd+shift+r -> descomentarclear all;close all;%Parametrosfs = 48000; %Frecuencia de muestreoTs=1/fs;T=1; %Druacion de la senal en segundost = Ts:Ts:T;  %Vector eje tiempoL=length(t);A1=2A3=1A2=1A4=1.5f1=330f2=440f3=550f4=660%Generación señalesx1=A1*cos(2*pi*f1*t);x2=A2*cos(2*pi*f2*t);x3=A3*cos(2*pi*f3*t);x4=A4*cos(2*pi*f4*t);R=randn(1,L); %Ruido blanco gaussianox=x1+x2+x3+x4+R; %con ruido, Borrar el R para sacarle el ruido%Plot#figure;##subplot(4,1,1);##plot(t,x1);##axis([0 0.05 -2 2])####subplot(4,1,2);##plot(t,x2);##axis([0 0.05 -2 2])####subplot(4,1,3);##plot(t,x3);##axis([0 0.05 -2 2])####subplot(4,1,4);##plot(t,x);##axis([0 0.05 -6 6])%Transformada de FourierX1=fftshift(fft(x1)); X2=fftshift(fft(x2)); X3=fftshift(fft(x3)); X=fftshift(fft(x)); f=-fs/2+fs/L:fs/L:fs/2; %eje frecuencia%Plot#figure;##subplot(4,1,1);##plot(f,abs(X1)/max(abs(X1)));  %normalizado##axis([-1000 1000 0 1.1])####subplot(4,1,2);##plot(f,abs(X2)/max(abs(X2)));  %normalizado##axis([-1000 1000 0 1.1])####subplot(4,1,3);##plot(f,abs(X3)/max(abs(X3)));  %normalizado##axis([-1000 1000 0 1.1])####subplot(4,1,4);##plot(f,abs(X)/max(abs(X)));  %normalizado##axis([-1000 1000 0 1.1])%Filtros%Paso bajo idealflow=500;  %Ejemplo de frecuencia de corte (Hz) Hdef_pb=zeros(1,L/2);Hdef_pb(1:flow/fs*L)=ones(1,flow/fs*L);Hdef_pb=[fliplr(Hdef_pb) Hdef_pb];%Paso alto idealfhigh=600; %Ejemplo de frecuencia de corte (Hz) Hdef_pa=ones(1,L/2);Hdef_pa(1:fhigh/fs*L)=zeros(1,fhigh/fs*L);Hdef_pa=[fliplr(Hdef_pa) Hdef_pa];%CombinasiónHdef=Hdef_pb;##Hdef=Hdef_pa;##Hdef=Hdef_pa+Hdef_pb;%Salida FiltroYdef=X.*Hdef;ydet=ifft(fftshift(Ydef));        %Cálculo de la transformada de Fourier inversaydet=real(ydet);%Plot filtro (el que importa)figure;subplot(4,1,1);plot(t,x);                        %función en tiempoaxis([0 0.1 -6 6])subplot(4,1,2);plot(f,abs(X)/max(abs(X)));       %función en frecuenciaaxis([-1000 1000 0 1.1])hold on;plot(f,abs(Hdef),"g")             %filtrosubplot(4,1,3)plot(f,abs(Ydef)/max(abs(Ydef))); %Salida Filtro en Frecuenciaaxis([-1000 1000 0 1.1])subplot(4,1,4)plot(t,ydet);                     %Salida Filtro en tiempoaxis([0 0.1 -6 6])%axis([0 0.1 -0.5 0.5])